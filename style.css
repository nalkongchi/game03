@import url('https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;600;700&family=Press+Start+2P&display=swap');
:root{
  --bg:#080614;--bg2:#100e22;--panel:#0e0c1e;
  --bdr:#2e2258;--bdr2:#5e44aa;
  --gold:#e8b830;--silver:#b8cce0;--text:#ddd0ff;--dim:#7564b2;
  --mana:#9050ff;--know:#40b0ff;--body:#40e880;--soc:#ffaa40;
  --red:#ff5f7a;--grn:#63ff9c;--pink:#ff6db2;--ora:#ffb15a;
  --px:'Press Start 2P', monospace;--sr:'Noto Serif KR', serif;--hud-offset:0px;--tabbar-offset:0px;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  background:var(--bg);color:var(--text);font-family:var(--sr);min-height:100vh;overflow-x:hidden;
  background-image:
    radial-gradient(ellipse at 15% 25%,rgba(80,40,160,.2) 0%,transparent 55%),
    radial-gradient(ellipse at 85% 75%,rgba(40,20,100,.25) 0%,transparent 55%);
}
.star{position:fixed;background:#fff;border-radius:50%;animation:tw 3s infinite;pointer-events:none;z-index:0}
@keyframes tw{0%,100%{opacity:.15}50%{opacity:.95}}
#app{position:relative;z-index:1;max-width:980px;margin:0 auto;padding:14px}
.screen{display:none !important}
.screen.active{display:block !important}
.screen-flex.active{display:flex !important}
.box{background:var(--panel);border:2px solid var(--bdr);position:relative;box-shadow:0 8px 30px rgba(0,0,0,.22)}
.box::after{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(94,68,170,.06) 0%,transparent 50%);pointer-events:none}
.btn{
  font-family:var(--px);font-size:12px;padding:14px 18px;background:linear-gradient(180deg,#241860 0%,#120c38 100%);
  border:2px solid var(--bdr2);color:var(--gold);cursor:pointer;letter-spacing:.6px;transition:all .15s;
  text-shadow:0 0 6px var(--gold);
}
.btn:hover{background:linear-gradient(180deg,#341d80,#241860);border-color:var(--gold);transform:translateY(-1px)}
.btn:active{transform:translateY(0)}
.btn:disabled{opacity:.4;cursor:default;transform:none}
.btn-sm{padding:10px 16px;font-size:10px}
.btn-xs{padding:8px 12px;font-size:9px}
.btn-red{border-color:var(--red);color:var(--red);text-shadow:0 0 6px var(--red)}
.btn-pink{border-color:var(--pink);color:var(--pink);text-shadow:0 0 6px var(--pink)}
.px9{font-family:var(--px);font-size:9px}
.px10{font-family:var(--px);font-size:10px}
.px11{font-family:var(--px);font-size:11px}
.px12{font-family:var(--px);font-size:12px}
hr.dv{border:none;border-top:1px solid var(--bdr);margin:14px 0}

/* BGM 버튼 화면 우측 상단 배치 (터치 방해 X) */
#bgm-toggle{
  position:absolute;top:14px;right:14px;z-index:100;
  font-family:var(--px);font-size:8px;padding:8px 12px;
  background:rgba(16,14,34,.8);border:1px solid var(--bdr2);
  color:var(--gold);cursor:pointer;border-radius:6px;
}
#bgm-toggle.off{color:var(--dim);border-color:var(--bdr);}

#screen-title{flex-direction:column;align-items:center;justify-content:center;min-height:100vh;gap:20px;text-align:center}
.ttl-em{font-size:72px;animation:flt 4s ease-in-out infinite;filter:drop-shadow(0 0 18px #9050ff)}
@keyframes flt{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.ttl-main{font-family:var(--px);font-size:clamp(14px,2.8vw,20px);color:var(--gold);text-shadow:0 0 18px var(--gold),2px 2px 0 #000;line-height:2}
.ttl-sub{font-family:var(--px);font-size:10px;color:var(--dim);letter-spacing:1px}

.cg{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media(max-width:700px){.cg{grid-template-columns:1fr}}
.sec-ttl{font-family:var(--px);font-size:10px;color:var(--know);margin-bottom:12px;border-bottom:1px solid var(--bdr);padding-bottom:6px;text-shadow:0 0 5px var(--know)}
.name-inp{width:100%;background:var(--bg2);border:2px solid var(--bdr);color:var(--text);font-family:var(--sr);font-size:18px;padding:12px 14px;outline:none;transition:border-color .2s}
.name-inp:focus{border-color:var(--bdr2)} .name-inp::placeholder{color:var(--dim)}
.srow{display:flex;align-items:center;gap:8px;margin-bottom:12px}
.slbl{font-family:var(--px);font-size:9px;width:66px;flex-shrink:0;line-height:1.6}
.sbw{flex:1;height:16px;background:var(--bg2);border:1px solid var(--bdr);position:relative}
.sbf{height:100%;transition:width .2s}.sbf::after{content:'';position:absolute;top:0;left:0;right:0;height:50%;background:rgba(255,255,255,.12)}
.sn{font-family:var(--px);font-size:9px;width:28px;text-align:right;flex-shrink:0}
.s-mana .sbf{background:var(--mana)} .s-know .sbf{background:var(--know)} .s-body .sbf{background:var(--body)} .s-soc .sbf{background:var(--soc)}
.sbtn{width:26px;height:26px;background:var(--bg2);border:1px solid var(--bdr);color:var(--text);cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center}
.sbtn:hover{background:var(--bdr2)}
.alloc-actions{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin-top:12px}

#screen-game{padding-top:calc(var(--hud-offset) + 12px);padding-bottom:calc(var(--tabbar-offset) + 24px);}
.hud-wrap{position:sticky;top:0;z-index:40;padding-top:4px;background:linear-gradient(180deg,rgba(8,6,20,.98) 0%,rgba(8,6,20,.85) 80%,transparent 100%)}
.hud{display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:12px;padding:12px 14px;margin-bottom:12px}
.hd-left{display:flex;align-items:center;gap:10px;min-width:0}
.me-img{width:52px;height:52px;object-fit:cover;border:2px solid var(--bdr2);border-radius:8px;image-rendering:pixelated;flex-shrink:0;cursor:pointer}
.hd-name{font-family:var(--px);font-size:12px;color:var(--gold);line-height:1.7;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:120px}
.hd-sub{font-size:13px;color:var(--dim);line-height:1.5}
.hd-date{font-family:var(--px);font-size:11px;color:var(--gold);text-align:center;line-height:1.7}
.hd-gold{font-family:var(--px);font-size:12px;color:var(--gold);text-align:right;white-space:nowrap}
.prog{width:100%;height:10px;background:var(--bg2);border:1px solid var(--bdr);margin-top:6px}
.progf{height:100%;background:linear-gradient(90deg,var(--mana),var(--know));transition:width .4s}
.stag{font-family:var(--px);font-size:9px;padding:4px 8px;border:1px solid;display:inline-block;margin-top:4px}
.sp{color:#90ff70;border-color:#90ff70}.su{color:#ffe060;border-color:#ffe060}.au{color:#ff8830;border-color:#ff8830}.wi{color:#70c0ff;border-color:#70c0ff}

.tab-panel{display:none}
.tab-panel.active{display:block}
.tabbox{padding:14px}
.mi{font-family:var(--px);font-size:11px;color:var(--gold);text-align:center;margin-bottom:12px;text-shadow:0 0 7px var(--gold);line-height:1.9}
.slots{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:12px}
.slot{padding:12px;border:1px solid var(--bdr);background:var(--bg2)}
.slot-lbl{font-family:var(--px);font-size:9px;color:var(--dim);margin-bottom:6px}
.slot-val{font-size:14px;color:var(--silver);line-height:1.7;min-height:44px}
.slot-val.empty{color:var(--dim)}
.preview-row{display:grid;grid-template-columns:minmax(0,1fr) 128px;gap:10px;margin-bottom:12px;align-items:stretch}
.preview-box{padding:12px;border:1px solid var(--bdr);background:rgba(16,14,34,.9);margin-bottom:0;min-width:0}
.preview-ttl{font-family:var(--px);font-size:10px;color:var(--know);margin-bottom:10px}
.preview-main{font-size:14px;line-height:1.8;color:var(--silver)}
.preview-sub{font-size:13px;line-height:1.8;color:var(--dim);margin-top:8px}
.preview-warn{color:var(--ora)}
.next-month-btn{width:100%;min-height:100%;display:flex;align-items:center;justify-content:center;text-align:center;font-size:13px;padding:14px 10px;line-height:1.7;word-break:keep-all}
.scroll-top-btn{position:fixed;right:16px;bottom:calc(var(--tabbar-offset) + 18px);z-index:75;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px;width:56px;height:56px;border:1px solid var(--gold);background:rgba(16,14,34,.96);color:var(--gold);font-family:var(--px);font-size:12px;cursor:pointer;opacity:0;pointer-events:none;transform:translateY(10px);transition:opacity .18s ease, transform .18s ease, box-shadow .18s ease;box-shadow:0 0 0 rgba(0,0,0,0)}
.scroll-top-btn span{font-size:8px;line-height:1.2}
.scroll-top-btn.show{opacity:1;pointer-events:auto;transform:translateY(0);box-shadow:0 6px 18px rgba(0,0,0,.35)}
.scroll-top-btn:hover{box-shadow:0 0 12px rgba(232,184,48,.3)}

/* 카테고리 (아코디언) UI - 크기 대폭 확대 */
.cat-wrap { margin-bottom: 14px; }
.cat-head { padding: 14px 16px; font-family: var(--px); font-size: 12px; color: var(--silver); border-left: 4px solid var(--bdr2); background: #1c1540; cursor: pointer; display: flex; justify-content: space-between; align-items: center; user-select: none; }
.cat-head:hover { background: #261d56; }
.cat-head::after { content: '▼'; font-size: 12px; transition: transform 0.2s; color: var(--gold); }
.cat-head.collapsed::after { transform: rotate(-90deg); color: var(--dim); }
.cat-head:focus-visible,.btn:focus-visible,.tab-btn:focus-visible,.chbtn:focus-visible,.sbtn:focus-visible,.ab:focus-visible,[role="button"]:focus-visible{outline:2px solid var(--gold);outline-offset:2px}
.cat-body { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px; }
@media(min-width: 740px) { .cat-body { grid-template-columns: repeat(3, 1fr); } }
.cat-body.collapsed { display: none; }

/* 활동 버튼 UI - 크기 키움 */
.ab{padding:14px 10px;background:var(--bg2);border:1px solid var(--bdr);color:var(--text);cursor:pointer;font-family:var(--sr);text-align:center;transition:all .12s;line-height:1.4}
.ab:hover{background:#19133a;border-color:var(--bdr2)}
.ab.sel{border-color:var(--mana);background:#1c1050}
.ab.dis{opacity:.45;cursor:not-allowed}
.ai{font-size:22px;display:block;margin-bottom:6px}
.an{font-size:15px;display:block;line-height:1.45; font-weight:600;}
.ac{font-size:13px;color:var(--dim);display:block;margin-top:6px;line-height:1.7}

/* 스탯 증감 색상 포맷팅 */
.c-pos { color: var(--grn); font-weight: 700; }
.c-neg { color: var(--red); font-weight: 700; }
.c-neu { color: var(--dim); }
.ac span, .preview-main span { display: inline-block; margin-right: 6px; }

.np{padding:14px}
.me-card{display:flex;align-items:center;gap:12px;padding:12px;background:var(--bg2);border:1px solid var(--bdr);cursor:pointer;margin-bottom:12px}
.me-card:hover{border-color:var(--bdr2);background:#19133a}
.me-card img{width:60px;height:60px;border-radius:8px;border:2px solid var(--bdr2);object-fit:cover;image-rendering:pixelated;flex-shrink:0}
.me-card .t1{font-family:var(--px);font-size:10px;color:var(--gold);line-height:1.8}
.me-card .t2{font-size:13px;color:var(--dim);line-height:1.6}
.nc{display:flex;align-items:center;gap:10px;padding:10px;background:var(--bg2);border:1px solid var(--bdr);cursor:pointer;transition:all .12s;margin-bottom:8px}
.nc:hover{background:#1c1840;border-color:var(--bdr2)} .nc.locked{opacity:.42;cursor:default}
.npc-img{width:56px;height:56px;object-fit:cover;border:2px solid var(--bdr);border-radius:8px;image-rendering:pixelated;flex-shrink:0}
.nn{font-family:var(--px);font-size:9px;display:block;margin-bottom:4px;line-height:1.6}
.nh{width:100%;height:8px;background:var(--bg);border:1px solid var(--bdr)}
.nhf{height:100%;background:linear-gradient(90deg,#d04070,#f050a0);transition:width .3s}
.hnum{font-family:var(--px);font-size:9px;color:var(--pink);flex-shrink:0}

.shop-box{padding:14px}
.sh-item{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:var(--bg2);border:1px solid var(--bdr);margin-bottom:10px;gap:12px}
.sh-name{font-size:15px;line-height:1.5;font-weight:600;}
.sh-desc{font-size:13px;color:var(--dim);line-height:1.5;margin-top:4px}

.stat-box{padding:14px}
.pttl{font-family:var(--px);font-size:10px;color:var(--know);margin-bottom:12px;border-bottom:1px solid var(--bdr);padding-bottom:8px;text-shadow:0 0 5px var(--know)}
.sdr{display:flex;align-items:center;gap:8px;margin-bottom:10px}
.sdlbl{font-family:var(--px);font-size:9px;width:60px;flex-shrink:0;line-height:1.5}
.sdb{flex:1;height:12px;background:var(--bg2);border:1px solid var(--bdr)}
.sdf{height:100%;transition:width .3s}
.sdn{font-family:var(--px);font-size:9px;width:28px;text-align:right;flex-shrink:0}
.sd-mana .sdf{background:var(--mana)} .sd-know .sdf{background:var(--know)} .sd-body .sdf{background:var(--body)} .sd-soc .sdf{background:var(--soc)}
.mr{display:flex;justify-content:space-between;margin-bottom:8px}
.fatb{width:100%;height:10px;background:var(--bg2);border:1px solid var(--bdr);margin-bottom:10px}
.fatf{height:100%;transition:width .3s}
.badge{display:inline-block;font-family:var(--px);font-size:9px;padding:4px 8px;border:1px solid;margin:3px 4px 0 0}
.b-ok{color:var(--grn);border-color:var(--grn)} .b-warn{color:var(--ora);border-color:var(--ora)} .b-bad{color:var(--red);border-color:var(--red)}
.log{padding:12px;max-height:260px;overflow-y:auto;margin-top:10px;border:1px solid var(--bdr);background:var(--bg2)}
.le{font-size:13px;color:var(--dim);margin-bottom:6px;line-height:1.75;border-left:3px solid var(--bdr);padding-left:8px;word-break:keep-all}
.le-ev{color:var(--ora);border-color:var(--ora)} .le-good{color:var(--grn);border-color:var(--grn)} .le-bad{color:var(--red);border-color:var(--red)} .le-heart{color:var(--pink);border-color:var(--pink)}

/* 하단 탭 메뉴 크기 빵빵하게 확대 */
#game-tabbar{position:fixed;left:0;right:0;bottom:0;z-index:70;background:rgba(8,6,20,.98);border-top:1px solid var(--bdr);display:flex;justify-content:center;gap:8px;padding:12px 10px calc(12px + env(safe-area-inset-bottom, 0px))}
.tab-btn{flex:1;max-width:200px;padding:18px 8px;background:var(--bg2);border:1px solid var(--bdr);color:var(--dim);font-family:var(--px);font-size:13px;cursor:pointer;transition:all .1s;}
.tab-btn.active{border-color:var(--gold);background:#1a1440;color:var(--gold);text-shadow:0 0 6px var(--gold)}

.ov{display:none;position:fixed;inset:0;background:rgba(0,0,0,.88);z-index:200;align-items:center;justify-content:center;backdrop-filter:blur(3px);padding:18px}
.ov.open{display:flex}
.ov[aria-hidden="true"]{display:none}
.ov.open[aria-hidden="false"]{display:flex}
.modal{max-width:500px;width:100%;padding:26px;animation:mIn .18s ease-out;max-height:90vh;overflow:auto}
.modal:focus{outline:2px solid var(--gold);outline-offset:2px}
@keyframes mIn{from{transform:scale(.94) translateY(16px);opacity:0}to{transform:scale(1) translateY(0);opacity:1}}
.m-ico{font-size:48px;text-align:center;margin-bottom:12px}
.m-ttl{font-family:var(--px);font-size:12px;color:var(--gold);text-align:center;margin-bottom:16px;text-shadow:0 0 8px var(--gold);line-height:1.8}
.m-txt{font-size:16px;line-height:1.9;color:var(--silver);text-align:center;margin-bottom:16px;word-break:keep-all}
.modal-desc{font-size:16px;line-height:1.95;color:var(--silver);text-align:left;word-break:keep-all;max-width:340px;margin:0 auto 16px}
.m-tags{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-bottom:16px}
.tag{font-family:var(--px);font-size:9px;padding:5px 9px;border:1px solid;background:rgba(0,0,0,.3)}
.tp{color:var(--grn);border-color:var(--grn)} .tn{color:var(--red);border-color:var(--red)}
.m-btns{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.choices{display:flex;flex-direction:column;gap:10px;margin-bottom:16px}
.chbtn{padding:14px;background:var(--bg2);border:1px solid var(--bdr);color:var(--text);cursor:pointer;font-family:var(--sr);font-size:15px;text-align:left;transition:all .12s;line-height:1.6;word-break:keep-all}
.chbtn:hover{background:#1c1840;border-color:var(--bdr2)}
.ev-img,.lv-img,.nm-img,.me-modal-img{width:110px;height:110px;object-fit:cover;display:block;margin:0 auto 14px;border:2px solid var(--bdr2);border-radius:10px;image-rendering:pixelated}
.nm-img,.me-modal-img{width:130px;height:130px}
.meta-list{font-size:15px;line-height:1.9;color:var(--silver);display:grid;gap:6px;max-width:340px;margin:0 auto 16px;text-align:left;word-break:keep-all}
.warn-box{font-size:15px;line-height:1.9;color:var(--silver);text-align:center;word-break:keep-all;margin-bottom:20px}

#screen-ending{flex-direction:column;align-items:center;justify-content:center;min-height:100vh;text-align:center;gap:20px;padding:36px 18px}
.en-ico{font-size:72px;animation:flt 4s ease-in-out infinite}
.en-ttl{font-family:var(--px);font-size:clamp(12px,2.4vw,18px);color:var(--gold);text-shadow:0 0 18px var(--gold);line-height:1.9}
.en-txt{max-width:540px;font-size:16px;line-height:2;color:var(--silver);word-break:keep-all}
.en-stats{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
.en-st{padding:10px 16px;border:1px solid var(--bdr);font-family:var(--px);font-size:9px;background:var(--panel);line-height:1.8}

::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:var(--bg)}::-webkit-scrollbar-thumb{background:var(--bdr)}
@media(max-width:480px){
  #app{padding:10px}
  .hd-name{max-width:88px;font-size:11px}
  .hd-gold{font-size:11px}
  .m-txt,.modal-desc{font-size:15px}
  .preview-row{grid-template-columns:minmax(0,1fr) 112px}
  .next-month-btn{font-size:12px;padding:12px 8px}
  .scroll-top-btn{right:12px;width:52px;height:52px}
  .cat-body{grid-template-columns:1fr 1fr}
}