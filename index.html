<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>마법사 수련생 아카데미 🔮</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<audio id="bgm" loop preload="auto">
  <source src="bgm.mp3" type="audio/mpeg">
</audio>

<button id="bgm-toggle" type="button">🎵 BGM ON</button>

<div id="app">

<div id="screen-title" class="screen screen-flex active">
  <div class="ttl-em">🔮</div>
  <div class="ttl-main">마법사 수련생<br>아카데미</div>
  <div class="ttl-sub">— MAGE ACADEMY v7.2 —</div>
  <div style="display:flex;gap:14px;flex-wrap:wrap;justify-content:center;margin-top:10px">
    <button class="btn" id="new-game-btn">✦ 새 게임</button>
    <button class="btn" id="load-btn" style="display:none">▶ 이어하기</button>
  </div>
  <div class="px11" style="color:var(--dim);margin-top:20px;line-height:2.2">5년의 수련 끝에 어떤 마법사가 될 것인가</div>
</div>

<div id="screen-create" class="screen" style="padding:18px 0">
  <div class="px12" style="color:var(--gold);text-align:center;margin-bottom:20px;text-shadow:0 0 10px var(--gold)">✦ 수련생 등록 ✦</div>
  <div class="cg">
    <div class="box" style="padding:18px">
      <div class="sec-ttl">이름 입력</div>
      <input type="text" class="name-inp" id="char-name" placeholder="이름을 입력하세요" maxlength="10">
      <hr class="dv">
      <div class="sec-ttl">능력치 배분 (포인트: 20)</div>
      <div id="stat-alloc"></div>
      <div style="text-align:right;margin-top:8px" class="px11">남은 포인트: <span id="pts" style="color:var(--grn)">20</span></div>
      <div class="alloc-actions">
        <button class="btn btn-sm" id="random-stat-btn">🎲 랜덤 배분</button>
      </div>
      <hr class="dv">
      <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap">
        <button class="btn btn-sm" id="back-btn">← 뒤로</button>
        <button class="btn btn-sm" id="start-btn">시작 →</button>
      </div>
    </div>
    <div class="box" style="padding:18px;text-align:center">
      <div class="sec-ttl">게임 안내</div>
      <img src="me.png" alt="주인공" style="width:100px;height:100px;object-fit:cover;border:2px solid var(--bdr2);border-radius:8px;margin:10px auto 14px;display:block;image-rendering:pixelated;cursor:pointer" data-action="open-me" data-from-create="true" role="button" tabindex="0">
      <hr class="dv">
      <div style="font-size:15px;color:var(--silver);line-height:2;text-align:left;word-break:keep-all">
        📅 5년 = 60개월<br>
        💸 생활비 월 10G 자동 차감<br>
        🧹 아르바이트 = 돈 벌기 / 성장 적음<br>
        📚 수업 = 돈 쓰기 / 성장 큼<br>
        🎭 사교 = 돈 쓰기 / 호감도·이벤트 강화<br>
        😴 무료 행동 = 회복·소성장<br>
        🎓 6개월마다 성적 우수 시 장학금 지급<br>
        🛌 피로 90+ → 다음 달 강제 휴식
      </div>
    </div>
  </div>
</div>

<div id="screen-game" class="screen">
  <div class="hud-wrap">
    <div class="box hud">
      <div class="hd-left">
        <img id="me-img" class="me-img" src="me.png" alt="주인공" data-action="open-me" role="button" tabindex="0">
        <div style="min-width:0">
          <div class="hd-name" id="hd-name">수련생</div>
          <div class="hd-sub">🧙‍♂️ 마법사 수련생</div>
        </div>
      </div>
      <div style="text-align:center;min-width:0">
        <div class="hd-date" id="hd-date">1년차 1월</div>
        <div id="hd-season"></div>
        <div class="prog"><div class="progf" id="hd-prog" style="width:0%"></div></div>
        <div class="px10" style="color:var(--dim);margin-top:4px" id="hd-turn">1/60</div>
      </div>
      <div style="text-align:right">
        <div class="hd-gold">💰 <span id="hd-gold">240</span>G</div>
        <div class="px10" style="margin-top:8px;color:var(--dim)">피로 <span id="hd-fatigue-txt" style="color:var(--grn)">0</span></div>
      </div>
    </div>
  </div>

  <div id="tab-train" class="tab-panel active">
    <div class="box tabbox">
      <div class="mi" id="m-info">1년차 1월 — 이달의 활동을 선택하세요</div>
      
      <div class="slots">
        <div class="slot"><div class="slot-lbl">🌅 오전</div><div class="slot-val empty" id="slot-am">선택 안 함</div></div>
        <div class="slot"><div class="slot-lbl">🌆 오후</div><div class="slot-val empty" id="slot-pm">선택 안 함</div></div>
      </div>
      
      <div class="action-row">
        <div class="preview-box" style="margin-bottom:0; display:flex; flex-direction:column;">
          <div class="preview-ttl">✦ 예상 변화</div>
          <div class="preview-main" id="preview-main" style="flex:1;">
            <span style="color:var(--dim);font-size:13px;">활동을 고르면<br>예상 변화가 표시돼요.</span>
          </div>
          <div class="preview-sub" id="preview-sub"></div>
        </div>
        
        <div style="display:flex; flex-direction:column; gap:10px;">
          <button class="btn btn-pink" id="date-btn-main" style="display:none; width:100%; font-size:12px; padding:12px;">💕 데이트 신청</button>
          
          <button class="btn" style="width:100%; font-size:15px; font-weight:bold; flex:1;" id="confirm-btn">다음 달 진행 ➔</button>
        </div>
      </div>

      <div style="font-size:13px;color:var(--dim);margin-bottom:12px;line-height:1.8;word-break:keep-all">활동 선택 (오전 → 오후 순). 데이트는 오후 슬롯을 사용해요.</div>
      
      <div id="act-grid"></div>
    </div>
  </div>

  <div id="tab-relations" class="tab-panel">
    <div class="box np">
      <div class="pttl">✦ 관계</div>
      <div class="me-card" data-action="open-me" role="button" tabindex="0">
        <img src="me.png" alt="주인공">
        <div>
          <div class="t1">주인공 상태 보기</div>
          <div class="t2">나의 현재 성장 방향과 가까운 인물을 확인해요.</div>
        </div>
      </div>
      <div id="npc-list"></div>
      <button class="btn btn-pink" id="date-btn" style="display:none;width:100%;margin-top:10px;font-size:14px;padding:14px;">💕 데이트 신청 (오후)</button>
    </div>
  </div>

  <div id="tab-shop" class="tab-panel">
    <div class="box shop-box">
      <div class="pttl">✦ 상점</div>
      <div id="shop-list"></div>
    </div>
  </div>

  <div id="tab-status" class="tab-panel">
    <div class="box stat-box">
      <div class="pttl">✦ 능력치</div>
      <div id="stat-panel"></div>
      <hr class="dv">
      <div class="pttl">✦ 상태</div>
      <div class="mr"><span class="px10" style="color:var(--dim)">피로도</span><span class="px10" id="fat-num">0/100</span></div>
      <div class="fatb"><div class="fatf" id="fat-fill" style="width:0%"></div></div>
      <div id="badges"></div>
      <hr class="dv" style="margin-top:14px">
      <div class="pttl">✦ 기록</div>
      <div class="log" id="log-panel"></div>
    </div>
  </div>

  <div id="game-tabbar">
    <button class="tab-btn active" data-tab="train">수련</button>
    <button class="tab-btn" data-tab="relations">관계</button>
    <button class="tab-btn" data-tab="shop">상점</button>
    <button class="tab-btn" data-tab="status">내 정보</button>
  </div>
</div>

<button id="scroll-top-btn" class="scroll-top-btn" type="button" aria-label="맨 위로 이동" aria-hidden="true">↑<span>위로</span></button>

<div id="screen-ending" class="screen screen-flex">
  <div class="en-ico" id="en-ico">✨</div>
  <div class="en-ttl" id="en-main-ttl">메인 엔딩</div>
  <div class="en-txt" id="en-main-txt"></div>
  <div class="box" id="en-side-wrap" style="max-width:540px;width:100%;padding:18px;display:none">
    <div class="px11" id="en-side-label" style="color:var(--pink);margin-bottom:12px;text-shadow:0 0 8px var(--pink)">💕 로맨스 에필로그</div>
    <div class="px12" id="en-side-ttl" style="color:var(--pink);margin-bottom:12px;line-height:1.8"></div>
    <div class="en-txt" id="en-side-txt" style="font-size:15px;max-width:none"></div>
  </div>
  <div class="box" style="max-width:540px;width:100%;padding:18px">
    <div class="px11" style="color:var(--know);margin-bottom:12px;text-shadow:0 0 8px var(--know)">✦ 수련 기록</div>
    <div id="en-meta" style="font-size:15px;line-height:2;color:var(--silver)"></div>
  </div>
  <div class="en-stats" id="en-stats"></div>
  <div style="display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-top:14px">
    <button class="btn" id="restart-btn" style="padding:16px 24px;font-size:13px">✦ 다시 시작</button>
  </div>
</div>

</div>

<div class="ov" id="ev-modal">
  <div class="box modal">
    <img id="ev-img" class="ev-img" style="display:none" alt="">
    <div class="m-ico" id="ev-ico">⚡</div>
    <div class="m-ttl" id="ev-ttl">제목</div>
    <div class="m-txt" id="ev-txt">내용</div>
    <div class="m-tags" id="ev-tags"></div>
    <div class="m-btns"><button class="btn" id="ev-close-btn">확인</button></div>
  </div>
</div>

<div class="ov" id="lv-modal">
  <div class="box modal">
    <img id="lv-img" class="lv-img" alt="">
    <div class="m-ico" id="lv-ico">💕</div>
    <div class="m-ttl" id="lv-ttl">제목</div>
    <div class="m-txt" id="lv-txt">내용</div>
    <div class="choices" id="lv-choices"></div>
  </div>
</div>

<div class="ov" id="date-modal">
  <div class="box modal">
    <div class="m-ttl">💕 데이트 상대 선택</div>
    <div class="m-txt" style="font-size:15px">호감도 25 이상인 인물과 데이트할 수 있어요.<br>데이트는 오후 활동 시간을 사용합니다.</div>
    <div class="choices" id="date-choices"></div>
    <div class="m-btns"><button class="btn btn-red" id="date-cancel-btn">취소</button></div>
  </div>
</div>

<div class="ov" id="npc-modal">
  <div class="box modal" style="max-width:390px">
    <img id="nm-img" class="nm-img" alt="">
    <div class="m-ttl" id="nm-name" style="margin-bottom:8px">이름</div>
    <div class="px11" id="nm-title" style="color:var(--dim);text-align:center;margin-bottom:14px;line-height:1.8">직함</div>
    <div class="modal-desc" id="nm-desc"></div>
    <div style="display:flex;align-items:center;gap:8px;margin-bottom:12px">
      <span class="px10" style="color:var(--dim);flex-shrink:0">호감도</span>
      <div style="flex:1;height:12px;background:var(--bg2);border:1px solid var(--bdr)"><div id="nm-hf" style="height:100%;background:linear-gradient(90deg,#d04070,#f050a0);transition:width .3s"></div></div>
      <span class="px10" style="color:var(--pink);flex-shrink:0" id="nm-hn">0/100</span>
    </div>
    <div class="px10" style="color:var(--dim);text-align:center;margin-bottom:8px" id="nm-stage"></div>
    <div class="px10" style="color:var(--dim);text-align:center;margin-bottom:16px" id="nm-next"></div>
    <div class="m-btns"><button class="btn" id="npc-close-btn">닫기</button></div>
  </div>
</div>

<div class="ov" id="me-modal">
  <div class="box modal" style="max-width:420px">
    <img src="me.png" class="me-modal-img" alt="주인공">
    <div class="m-ttl">나의 상태</div>
    <div class="meta-list" id="me-meta-list"></div>
    <div class="modal-desc" id="me-desc" style="margin-bottom:18px"></div>
    <div class="m-btns"><button class="btn" id="me-close-btn">닫기</button></div>
  </div>
</div>

<div class="ov" id="warn-modal">
  <div class="box modal" style="max-width:380px">
    <div class="m-ico">⚠️</div>
    <div class="m-ttl">확인</div>
    <div class="warn-box" id="warn-text">경고</div>
    <div class="m-btns">
      <button class="btn btn-red" id="warn-cancel-btn">취소</button>
      <button class="btn" id="warn-ok-btn">그대로 진행</button>
    </div>
  </div>
</div>

<script src="data.js"></script>
<script src="game.js"></script>
</body>
</html>
